<page-header model="ctrl.navModel"></page-header>

<div class="page-container page-body">
  <div class="page-action-bar" ng-show="ctrl.folderTitle">
      <div class="gf-form gf-form--grow">
          <h3 class="page-sub-heading">
            <i class="fa fa-folder-open"></i>&nbsp;{{ctrl.folderTitle}}
          </h3>
      </div>
      <div class="page-action-bar__spacer"></div>
      <button class="btn btn-inverse" disabled>Permissions</button>
      <a class="btn btn-success" href="/dashboard/new">
        <i class="fa fa-plus"></i>
        Dashboard
      </a>
      <a class="btn btn-success" href="/dashboard/new/?editview=new-folder">
        <i class="fa fa-plus"></i>
        Folder
      </a>
    </div>

  <div class="page-action-bar">
    <div class="gf-form gf-form--grow">
      <label class="gf-form-label">Search</label>
      <input type="text" class="gf-form-input max-width-30" placeholder="Find Dashboard by name" tabindex="1" give-focus="true" ng-model="ctrl.query.query" ng-model-options="{ debounce: 500 }" spellcheck='false' ng-change="ctrl.onQueryChange()" />
    </div>
    <div class="page-action-bar__spacer"></div>
    <a class="btn btn-success" href="/dashboard/new" ng-hide="ctrl.folderTitle">
      <i class="fa fa-plus"></i>
      Dashboard
    </a>
    <a class="btn btn-success" href="/dashboard/new/?editview=new-folder" ng-hide="ctrl.folderTitle">
      <i class="fa fa-plus"></i>
      Folder
    </a>
  </div>

  <div class="gf-form" ng-if="ctrl.query.tag.length">
    Filters:
    <span ng-repeat="tagName in ctrl.query.tag">
      <a ng-click="ctrl.removeTag(tagName, $event)" tag-color-from-name="tagName" class="label label-tag">
        <i class="fa fa-remove"></i>
        {{tagName}}
      </a>
    </span>
  </div>

  <div class="gf-form">
      <div class="gf-form-button-row"
        ng-show="ctrl.hasFilters">
        <button
          type="button"
          class="btn gf-form-button btn-inverse btn-small"
          ng-click="ctrl.clearFilters()">
          <i class="fa fa-close"></i> Clear current search query and filters
      </button>
      </div>
  </div>

  <div ng-if="!ctrl.hasFilters && ctrl.sections.length === 0">
    <empty-list-cta model="{
      title: 'This folder doesn\'t have any dashboards yet',
      buttonIcon: 'gicon gicon-dashboard-new',
      buttonLink: '/dashboard/new',
      buttonTitle: 'Create Dashboard',
      proTip: 'You can bulk move dashboards into this folder from the main dashboard list.',
      proTipLink: 'http://docs.grafana.org/administration/provisioning/#datasources?utm_source=grafana_ds_list',
      proTipLinkTitle: 'Learn more',
      proTipTarget: '_blank'
    }" />
  </div>

  <div class="dashboard-list" ng-show="ctrl.sections.length > 0">
    <div class="search-results-filter-row">
      <gf-form-switch
        on-change="ctrl.onSelectAllChanged()"
        checked="ctrl.selectAllChecked"
        switch-class="gf-form-switch--transparent gf-form-switch--search-result-filter-row__checkbox"
      />
      <div class="search-results-filter-row__filters">
        <select
          class="search-results-filter-row__filters-item gf-form-input"
          ng-model="ctrl.selectedStarredFilter"
          ng-options="t.text disable when t.disabled for t in ctrl.starredFilterOptions"
          ng-change="ctrl.onStarredFilterChange()"
          ng-show="!(ctrl.canMove || ctrl.canDelete)"
        />
        <select
          class="search-results-filter-row__filters-item gf-form-input"
          ng-model="ctrl.selectedTagFilter"
          ng-options="t.term disable when t.disabled for t in ctrl.tagFilterOptions"
          ng-change="ctrl.onTagFilterChange()"
          ng-show="!(ctrl.canMove || ctrl.canDelete)"
        />
        <div class="gf-form-button-row" ng-show="ctrl.canMove || ctrl.canDelete">
          <button	type="button"
              class="btn gf-form-button btn-inverse"
              ng-disabled="!ctrl.canMove"
              ng-click="ctrl.moveTo()"
              bs-tooltip="ctrl.canMove ? '' : 'Select a dashboard to move (cannot move folders)'"
              data-placement="bottom">
            <i class="fa fa-exchange"></i>&nbsp;&nbsp;Move
          </button>
          <button  type="button"
              class="btn gf-form-button btn-danger"
              ng-click="ctrl.delete()"
              ng-disabled="!ctrl.canDelete">
              <i class="fa fa-trash"></i>&nbsp;&nbsp;Delete
          </button>
        </div>
      </div>
    </div>
    <div class="search-results-container">
      <dashboard-search-results
        results="ctrl.sections"
        editable="true"
        on-selection-changed="ctrl.selectionChanged()"
        on-tag-selected="ctrl.filterByTag($tag)" />
    </div>
  </div>
</div>
