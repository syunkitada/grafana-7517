<div ng-if="ctrl.editMode">
  <div class="dash-row-header">
    <a class="dash-row-header-title" ng-click="ctrl.toggleCollapse()">
      <span class="dash-row-collapse-toggle pointer">
        <i class="fa fa-chevron-down" ng-show="!ctrl.row.collapse"></i>
        <i class="fa fa-chevron-right" ng-show="ctrl.row.collapse"></i>
      </span>
      <span ng-class="ctrl.row.titleSize">{{ctrl.row.title | interpolateTemplateVars:this}}</span>
    </a>

    <div class="dash-row-header-spacer">
    </div>

    <div class="dash-row-header-actions">
      <a class="pointer dash-row-header-action-add-panel" ng-click="ctrl.showAddPanel()" ng-class="{active: ctrl.dropView===1}">
        Add Panel
        <i class="fa fa-plus" ng-hide="ctrl.dropView===1"></i>
        <i class="fa fa-remove" ng-show="ctrl.dropView===1"></i>
      </a>
      <a class="pointer dash-row-header-action-show-options" ng-click="ctrl.showRowOptions()" ng-class="{active: ctrl.dropView===2}">
        Row Options
        <i class="fa fa-cog" ng-hide="ctrl.dropView===2"></i>
        <i class="fa fa-remove" ng-show="ctrl.dropView===2"></i>
      </a>
      <a class="pointer dash-row-header-actions--tight" bs-tooltip="'Move row up'" ng-click="ctrl.moveRow(-1)">
        <i class="fa fa-arrow-up"></i>
      </a>
      <a class="pointer dash-row-header-actions--tight" bs-tooltip="'Move row down'" ng-click="ctrl.moveRow(1)">
        <i class="fa fa-arrow-down"></i>
      </a>
    </div>
  </div>

  <div ng-if="ctrl.dropView === 1">
    <dash-row-add-panel row-ctrl="ctrl"></dash-row-add-panel>
  </div>

  <div ng-if="ctrl.dropView === 2">
    <dash-row-options row-ctrl="ctrl"></dash-row-options>
  </div>
</div>

<div ng-if="!ctrl.editMode">
  <div class="row-open">
    <div class='row-tab dropdown' ng-show="dashboardMeta.canEdit" ng-hide="dashboard.meta.fullscreen">
      <span class="row-tab-button dropdown-toggle" data-toggle="dropdown">
        <i class="fa fa-bars"></i>
      </span>
      <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="drop1">
        <li>
          <a ng-click="ctrl.onMenuAddPanel()">Add Panel</a>
        </li>
        <li>
          <a ng-click="ctrl.onMenuRowOptions()">Row Options</a>
        </li>
        <li>
          <a ng-click="ctrl.onMenuDeleteRow()">Delete row</a>
        </li>
      </ul>
    </div>
  </div>

  <div class="dash-row-header" ng-if="ctrl.showtitle">
    <a class="dash-row-header-title" ng-click="ctrl.toggleCollapse()">
      <span class="dash-row-collapse-toggle pointer">
        <i class="fa fa-chevron-down" ng-show="!ctrl.row.collapse"></i>
        <i class="fa fa-chevron-right" ng-show="ctrl.row.collapse"></i>
      </span>
      <span ng-class="ctrl.row.titleSize">{{ctrl.row.title | interpolateTemplateVars:this}}</span>
    </a>
  </div>
</div>

<div class="panels-wrapper" ng-if="!ctrl.row.collapse">
  <div ng-repeat="panel in ctrl.row.panels track by panel.id" class="panel" ui-draggable="!ctrl.dashboard.meta.fullscreen" drag="panel.id" ui-on-drop="ctrl.onDrop($data, panel)" drag-handle-class="drag-handle" panel-width>
    <plugin-component type="panel" class="panel-margin">
    </plugin-component>
  </div>

  <div panel-drop-zone class="panel panel-drop-zone" ui-on-drop="ctrl.onDrop($data)" data-drop="true">
    <div class="panel-margin">
      <div class="panel-container">
        <div class="panel-drop-zone-text"></div>
      </div>
    </div>
  </div>

  <div class="clearfix"></div>
</div>

