<div ng-controller='filtering' ng-init="init()">
  <style>
    .filtering-container {
      float: left;
    }
    .filter-panel-filter {
      display:inline-block;
      vertical-align: top;
      padding: 5px 10px 0px 10px;
      margin: 0px 5px;
      border-left: 1px solid #111;
      border-right: 1px solid #111;
    }
    .filter-panel-filter ul {
      margin-bottom: 3px;
    }

    .filter-deselected {
      opacity: 0.5;
    }
    .filter-action {
      float:right;
      margin-bottom: 0px !important;
      margin-left: 3px;
      margin-top: 3px;
    }
    .add-filter-action {
      position: relative;
      top: 4px;
    }
    .filter-mandate {
      text-decoration: underline;
      cursor: pointer;
    }
    .filter-apply {
      float:right;
    }
  </style>

  <div class='filtering-container'>
    <span ng-show="filterSrv.list.length == 0">
      <h5>No filters available</h5>
    </span>
    <div ng-repeat="filter in filterSrv.list" class="small filter-panel-filter">
      <div>
        <i class="filter-action pointer icon-remove" bs-tooltip="'Remove'" ng-click="remove(filter)"></i>
        <i class="filter-action pointer icon-edit" ng-hide="filter.editing" bs-tooltip="'Edit'" ng-click="filter.editing = true"></i>
      </div>

      <div ng-hide="filter.editing" style="margin-right: 45px;">
        <ul class="unstyled">
          <li ng-if="filter.name" class="dropdown">
            {{filter.name}} :
            <a class="dropdown-toggle" data-toggle="dropdown">
              {{filter.current.text}}
            </a>
              <ul class="dropdown-menu">
                <li ng-repeat="option in filter.options">
                  <a ng-click="filter.current = option">{{option.text}}</a>
                </li>
              </ul>
          </li>
        </ul>
      </div>

      <form ng-show="filter.editing">
        <ul class="unstyled">
          <li>
            <strong>name</strong>:<br/>
            <input type='text' ng-model="filter.name">
          </li>
          <li>
            <strong>filter.query</strong>:<br/>
            <input type='text' ng-model="filter.query">
          </li>
          <li>
            <strong>Include All</strong> : <input type='checkbox' ng-model="filter.includeAll">
          </li>
        </ul>
        <div>
          <input type="submit" value="Apply" ng-click="applyFilter(filter)" class="filter-apply btn btn-success btn-mini" bs-tooltip="'Save and refresh'"/>

          <button ng-click="filter.editing=undefined" class="filter-apply btn btn-mini" bs-tooltip="'Save without refresh'">Save</button>
        </div>
      </form>
    </div>
    <i class="pointer icon-plus-sign add-filter-action" ng-click="add()" bs-tooltip="'Add metric filter / param'" data-placement="right"></i>
  </div>
</div>